---
url: "https://supabase.com/docs/guides/database/extensions/wrappers/duckdb"
title: "DuckDB | Supabase Docs"
---

[![Supabase wordmark](https://supabase.com/docs/supabase-dark.svg)![Supabase wordmark](https://supabase.com/docs/supabase-light.svg)DOCS](https://supabase.com/docs)

- [Start](https://supabase.com/docs/guides/getting-started)
- Products
- Build
- Manage
- Reference
- Resources

[![Supabase wordmark](https://supabase.com/docs/supabase-dark.svg)![Supabase wordmark](https://supabase.com/docs/supabase-light.svg)DOCS](https://supabase.com/docs)

Search docs...

K

[Sign up](https://supabase.com/dashboard)

Main menu

[Database](https://supabase.com/docs/guides/database/overview)

[Overview](https://supabase.com/docs/guides/database/overview)

Fundamentals[Connecting to your database](https://supabase.com/docs/guides/database/connecting-to-postgres)
[Importing data](https://supabase.com/docs/guides/database/import-data)
[Securing your data](https://supabase.com/docs/guides/database/secure-data)

Working with your database (basics)[Managing tables, views, and data](https://supabase.com/docs/guides/database/tables)
[Working with arrays](https://supabase.com/docs/guides/database/arrays)
[Managing indexes](https://supabase.com/docs/guides/database/postgres/indexes)
[Querying joins and nested tables](https://supabase.com/docs/guides/database/joins-and-nesting)
[JSON and unstructured data](https://supabase.com/docs/guides/database/json)

Working with your database (intermediate)[Implementing cascade deletes](https://supabase.com/docs/guides/database/postgres/cascade-deletes)
[Managing enums](https://supabase.com/docs/guides/database/postgres/enums)
[Managing database functions](https://supabase.com/docs/guides/database/functions)
[Managing database triggers](https://supabase.com/docs/guides/database/postgres/triggers)
[Managing database webhooks](https://supabase.com/docs/guides/database/webhooks)
[Using Full Text Search](https://supabase.com/docs/guides/database/full-text-search)
[Partitioning your tables](https://supabase.com/docs/guides/database/partitions)
[Managing connections](https://supabase.com/docs/guides/database/connection-management)
[Managing event triggers](https://supabase.com/docs/guides/database/postgres/event-triggers)

OrioleDB[Overview](https://supabase.com/docs/guides/database/orioledb)

Access and security[Row Level Security](https://supabase.com/docs/guides/database/postgres/row-level-security)
[Column Level Security](https://supabase.com/docs/guides/database/postgres/column-level-security)
[Hardening the Data API](https://supabase.com/docs/guides/database/hardening-data-api)
[Custom Claims & RBAC](https://supabase.com/docs/guides/database/postgres/custom-claims-and-role-based-access-control-rbac)
[Managing Postgres Roles](https://supabase.com/docs/guides/database/postgres/roles)
[Using Custom Postgres Roles](https://supabase.com/docs/guides/storage/schema/custom-roles)
[Managing secrets with Vault](https://supabase.com/docs/guides/database/vault)
[Superuser Access and Unsupported Operations](https://supabase.com/docs/guides/database/postgres/roles-superuser)

Configuration, optimization, and testing[Database configuration](https://supabase.com/docs/guides/database/postgres/configuration)
[Query optimization](https://supabase.com/docs/guides/database/query-optimization)
[Database Advisors](https://supabase.com/docs/guides/database/database-advisors)
[Testing your database](https://supabase.com/docs/guides/database/testing)
[Customizing Postgres config](https://supabase.com/docs/guides/database/custom-postgres-config)

Debugging[Timeouts](https://supabase.com/docs/guides/database/postgres/timeouts)
[Debugging and monitoring](https://supabase.com/docs/guides/database/inspect)
[Debugging performance issues](https://supabase.com/docs/guides/database/debugging-performance)
[Supavisor](https://supabase.com/docs/guides/database/supavisor)
[Troubleshooting](https://supabase.com/docs/guides/database/troubleshooting)

ORM Quickstarts

Prisma

[Drizzle](https://supabase.com/docs/guides/database/drizzle)
[Postgres.js](https://supabase.com/docs/guides/database/postgres-js)

GUI quickstarts[pgAdmin](https://supabase.com/docs/guides/database/pgadmin)
[PSQL](https://supabase.com/docs/guides/database/psql)
[DBeaver](https://supabase.com/docs/guides/database/dbeaver)
[Metabase](https://supabase.com/docs/guides/database/metabase)
[Beekeeper Studio](https://supabase.com/docs/guides/database/beekeeper-studio)

Database replication[Overview](https://supabase.com/docs/guides/database/replication)

Replication

Manual replication

Extensions[Overview](https://supabase.com/docs/guides/database/extensions)
[HypoPG: Hypothetical indexes](https://supabase.com/docs/guides/database/extensions/hypopg)
[plv8 (deprecated)](https://supabase.com/docs/guides/database/extensions/plv8)
[http: RESTful Client](https://supabase.com/docs/guides/database/extensions/http)
[index\_advisor: Query optimization](https://supabase.com/docs/guides/database/extensions/index_advisor)
[PGAudit: Postgres Auditing](https://supabase.com/docs/guides/database/extensions/pgaudit)
[pgjwt (deprecated)](https://supabase.com/docs/guides/database/extensions/pgjwt)
[PGroonga: Multilingual Full Text Search](https://supabase.com/docs/guides/database/extensions/pgroonga)
[pgRouting: Geospatial Routing](https://supabase.com/docs/guides/database/extensions/pgrouting)
[pg\_cron: Schedule Recurring Jobs](https://supabase.com/docs/guides/database/extensions/pg_cron)
[pg\_graphql: GraphQL Support](https://supabase.com/docs/guides/database/extensions/pg_graphql)
[pg\_hashids: Short UIDs](https://supabase.com/docs/guides/database/extensions/pg_hashids)
[pg\_jsonschema: JSON Schema Validation](https://supabase.com/docs/guides/database/extensions/pg_jsonschema)
[pg\_net: Async Networking](https://supabase.com/docs/guides/database/extensions/pg_net)
[pg\_plan\_filter: Restrict Total Cost](https://supabase.com/docs/guides/database/extensions/pg_plan_filter)
[postgres\_fdw: query data from an external Postgres server](https://supabase.com/docs/guides/database/extensions/postgres_fdw)
[pgvector: Embeddings and vector similarity](https://supabase.com/docs/guides/database/extensions/pgvector)
[pg\_stat\_statements: SQL Planning and Execution Statistics](https://supabase.com/docs/guides/database/extensions/pg_stat_statements)
[pg\_repack: Storage Optimization](https://supabase.com/docs/guides/database/extensions/pg_repack)
[PostGIS: Geo queries](https://supabase.com/docs/guides/database/extensions/postgis)
[pgmq: Queues](https://supabase.com/docs/guides/database/extensions/pgmq)
[pgsodium (pending deprecation): Encryption Features](https://supabase.com/docs/guides/database/extensions/pgsodium)
[pgTAP: Unit Testing](https://supabase.com/docs/guides/database/extensions/pgtap)
[plpgsql\_check: PL/pgSQL Linter](https://supabase.com/docs/guides/database/extensions/plpgsql_check)
[timescaledb (deprecated)](https://supabase.com/docs/guides/database/extensions/timescaledb)
[uuid-ossp: Unique Identifiers](https://supabase.com/docs/guides/database/extensions/uuid-ossp)
[RUM: inverted index for full-text search](https://supabase.com/docs/guides/database/extensions/rum)

Foreign Data Wrappers[Overview](https://supabase.com/docs/guides/database/extensions/wrappers/overview)
[Connecting to Auth0](https://supabase.com/docs/guides/database/extensions/wrappers/auth0)
[Connecting to Airtable](https://supabase.com/docs/guides/database/extensions/wrappers/airtable)
[Connecting to AWS Cognito](https://supabase.com/docs/guides/database/extensions/wrappers/cognito)
[Connecting to AWS S3](https://supabase.com/docs/guides/database/extensions/wrappers/s3)
[Connecting to AWS S3 Vectors](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors)
[Connecting to BigQuery](https://supabase.com/docs/guides/database/extensions/wrappers/bigquery)
[Connecting to Clerk](https://supabase.com/docs/guides/database/extensions/wrappers/clerk)
[Connecting to ClickHouse](https://supabase.com/docs/guides/database/extensions/wrappers/clickhouse)
[Connecting to DuckDB](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb)
[Connecting to Firebase](https://supabase.com/docs/guides/database/extensions/wrappers/firebase)
[Connecting to Iceberg](https://supabase.com/docs/guides/database/extensions/wrappers/iceberg)
[Connecting to Logflare](https://supabase.com/docs/guides/database/extensions/wrappers/logflare)
[Connecting to MSSQL](https://supabase.com/docs/guides/database/extensions/wrappers/mssql)
[Connecting to Notion](https://supabase.com/docs/guides/database/extensions/wrappers/notion)
[Connecting to Paddle](https://supabase.com/docs/guides/database/extensions/wrappers/paddle)
[Connecting to Redis](https://supabase.com/docs/guides/database/extensions/wrappers/redis)
[Connecting to Snowflake](https://supabase.com/docs/guides/database/extensions/wrappers/snowflake)
[Connecting to Stripe](https://supabase.com/docs/guides/database/extensions/wrappers/stripe)

Examples[Drop All Tables in Schema](https://supabase.com/docs/guides/database/postgres/dropping-all-tables-in-schema)
[Select First Row per Group](https://supabase.com/docs/guides/database/postgres/first-row-in-group)
[Print PostgreSQL Version](https://supabase.com/docs/guides/database/postgres/which-version-of-postgres)
[Replicating from Supabase to External Postgres](https://supabase.com/docs/guides/database/postgres/setup-replication-external)

[![Supabase wordmark](https://supabase.com/docs/supabase-dark.svg)![Supabase wordmark](https://supabase.com/docs/supabase-light.svg)DOCS](https://supabase.com/docs)

- [Start](https://supabase.com/docs/guides/getting-started)
- Products
- Build
- Manage
- Reference
- Resources

[![Supabase wordmark](https://supabase.com/docs/supabase-dark.svg)![Supabase wordmark](https://supabase.com/docs/supabase-light.svg)DOCS](https://supabase.com/docs)

Search docs...

K

[Sign up](https://supabase.com/dashboard)

Database

1. [Database](https://supabase.com/docs/guides/database/overview)
3. Foreign Data Wrappers
5. [Connecting to DuckDB](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb)

# DuckDB

* * *

[DuckDB](https://duckdb.org/) is an open-source column-oriented Relational Database Management System.

The DuckDB Wrapper allows you to read data from DuckDB within your Postgres database.

## Preparation [\#](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb\#preparation)

Before you can query DuckDB, you need to enable the Wrappers extension and store your credentials in Postgres.

### Enable Wrappers [\#](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb\#enable-wrappers)

Make sure the `wrappers` extension is installed on your database:

```
1
create extension if not exists wrappers with schema extensions;
```

### Enable the DuckDB Wrapper [\#](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb\#enable-the-duckdb-wrapper)

Enable the `duckdb_wrapper` FDW:

```
1
create foreign data wrapper duckdb_wrapper
2
  handler duckdb_fdw_handler
3
  validator duckdb_fdw_validator;
```

### Store your credentials (optional) [\#](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb\#store-your-credentials-optional)

By default, Postgres stores FDW credentials inside `pg_catalog.pg_foreign_server` in plain text. Anyone with access to this table will be able to view these credentials. Wrappers is designed to work with [Vault](https://supabase.com/docs/guides/database/vault), which provides an additional level of security for storing credentials. We recommend using Vault to store your credentials.

DuckDB can connect to many data sources, the credential to be saved in Vault depends on which data source you're going to use. For example, to store AWS credentials for S3 connection, you can run below SQL and note down the secret IDs returned:

```
1
-- Save your AWS credentials in Vault and retrieve the created
2
-- `aws_access_key_id` and `aws_secret_access_key`
3
select vault.create_secret(
4
  '<access key id>',  -- secret to be encrypted
5
  'aws_access_key_id',  -- secret name
6
  'AWS access key for Wrappers'  -- secret description
7
);
8
select vault.create_secret(
9
  '<secret access key>'
10
  'aws_secret_access_key',
11
  'AWS secret access key for Wrappers'
12
);
```

### Connecting to DuckDB [\#](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb\#connecting-to-duckdb)

We need to provide Postgres with the credentials to connect to DuckDB. We can do this using the `create server` command. Depends on the data source, there are different server options needs to be specified. Below is the list of supported data sources and their corresponding server options.

For any server options need to be stored in Vault, you can add a prefix `vault_` to its name and use the secret ID returned from the `select vault.create_secret()` statement as the option value.

#### AWS S3 [\#](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb\#aws-s3)

| Server Option | Description | Required | Default |
| --- | --- | :-: | --- |
| type | Server type, must be `s3` | Y |  |
| key\_id | The ID of the key to use | Y |  |
| secret | The secret of the key to use | Y |  |
| region | The region for which to authenticate |  | `us-east-1` |
| endpoint | Specify a custom S3 endpoint |  | `s3.amazonaws.com` |
| session\_token | A session token passed to use as temporary credentials |  |  |
| url\_compatibility\_mode | Can help when URLs contain problematic characters |  | `true` |
| url\_style | Either `vhost` or `path` |  | `vhost` |
| use\_ssl | Whether to use HTTPS or HTTP |  | `true` |
| kms\_key\_id | AWS KMS (Key Management Service) key for Server Side Encryption S3 |  |  |

A `create server` statement example:

With VaultWithout Vault

```
1
create server duckdb_server
2
  foreign data wrapper duckdb_wrapper
3
  options (
4
    type 's3',
5

6
    -- The key id saved in Vault
7
    vault_key_id '<key_ID>',
8

9
    -- The secret saved in Vault
10
    vault_secret '<secret_key>',
11

12
    -- AWS region
13
    region 'us-east-1'
14
  );
```

This `s3` server type can also be used for other S3-compatible storage services such like [Supabase Storage](https://supabase.com/docs/guides/storage). For example,

```
1
create server duckdb_server
2
  foreign data wrapper duckdb_wrapper
3
  options (
4
    type 's3',
5
    key_id '<key_ID>',
6
    secret '<secret_key>',
7
    region 'us-east-1',
8
    url_style 'path',
9
	endpoint 'bctmhusapdbcvpetbnev.supabase.co/storage/v1/s3'
10
  );
```

#### AWS S3 Tables [\#](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb\#aws-s3-tables)

| Server Option | Description | Required | Default |
| --- | --- | :-: | --- |
| type | Server type, must be `s3_tables` | Y |  |
| key\_id | The ID of the key to use | Y |  |
| secret | The secret of the key to use | Y |  |
| s3\_tables\_arn | S3 Tables ARN (available in the AWS Management Console) | Y |  |
| region | The region for which to authenticate |  | `us-east-1` |

A `create server` statement example:

With VaultWithout Vault

```
1
create server duckdb_server
2
  foreign data wrapper duckdb_wrapper
3
  options (
4
    type 's3_tables',
5

6
    -- The key id saved in Vault
7
    vault_key_id '<key_ID>',
8

9
    -- The secret saved in Vault
10
    vault_secret '<secret_key>',
11

12
    -- AWS region
13
    region 'us-east-1',
14

15
    -- S3 Tables ARN
16
    s3_tables_arn 'arn:aws:s3tables:us-east-1:203212701384:bucket/my-bucket'
17
  );
```

#### Cloudflare R2 [\#](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb\#cloudflare-r2)

This is to access [Cloudflare R2](https://developers.cloudflare.com/r2/) using the [S3 Compatibility API](https://developers.cloudflare.com/r2/api/s3/api/).

| Server Option | Description | Required | Default |
| --- | --- | :-: | --- |
| type | Server type, must be `r2` | Y |  |
| key\_id | The ID of the key to use | Y |  |
| secret | The secret of the key to use | Y |  |
| account\_id | The account ID to use | Y |  |

A `create server` statement example:

With VaultWithout Vault

```
1
create server duckdb_server
2
  foreign data wrapper duckdb_wrapper
3
  options (
4
    type 'r2',
5

6
    -- The key id saved in Vault
7
    vault_key_id '<key_ID>',
8

9
    -- The secret saved in Vault
10
    vault_secret '<secret_key>',
11

12
    -- Account ID
13
    account_id '<account_ID>'
14
  );
```

#### Cloudflare R2 Data Catalog [\#](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb\#cloudflare-r2-data-catalog)

This is to access [Cloudflare R2 Data Catalog](https://developers.cloudflare.com/r2/data-catalog/).

| Server Option | Description | Required | Default |
| --- | --- | :-: | --- |
| type | Server type, must be `r2_catalog` | Y |  |
| token | The R2 API token to use | Y |  |
| warehouse | Warehouse name in R2 Data Catalog | Y |  |
| catalog\_uri | R2 Data Catalog URI | Y |  |

A `create server` statement example:

With VaultWithout Vault

```
1
create server duckdb_server
2
  foreign data wrapper duckdb_wrapper
3
  options (
4
    type 'r2_catalog',
5

6
    -- The R2 API token saved in Vault
7
    vault_token '<token>',
8

9
    -- Warehouse name
10
    warehouse 'my_warehouse',
11

12
    -- R2 Data Catalog URI
13
    catalog_uri 'catalog.cloudflarestorage.com/1a4d06e707l56a1a724719292be42e3a/r2-data-catalog'
14
  );
```

#### Apache Polaris [\#](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb\#apache-polaris)

This is to access [Apache Polaris](https://polaris.apache.org/) Iceberg service.

| Server Option | Description | Required | Default |
| --- | --- | :-: | --- |
| type | Server type, must be `polaris` | Y |  |
| client\_id | The client ID to use | Y |  |
| client\_secret | The client secret to use | Y |  |
| warehouse | Warehouse name | Y |  |
| catalog\_uri | Polaris REST Catalog URI | Y |  |

A `create server` statement example:

With VaultWithout Vault

```
1
create server duckdb_server
2
  foreign data wrapper duckdb_wrapper
3
  options (
4
    type 'polaris',
5

6
    -- The client id saved in Vault
7
    vault_client_id '<client_id>',
8

9
    -- The client secret in Vault
10
    vault_client_secret '<secret>',
11

12
    -- Warehouse name
13
    warehouse 'quickstart_catalog',
14

15
    -- Polaris REST Catalog URI
16
    catalog_uri '<polaris_rest_catalog_endpoint>'
17
  );
```

#### Lakekeeper [\#](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb\#lakekeeper)

This is to access [Lakekeeper](https://docs.lakekeeper.io/) Iceberg service.

| Server Option | Description | Required | Default |
| --- | --- | :-: | --- |
| type | Server type, must be `lakekeeper` | Y |  |
| client\_id | The client ID to use | Y |  |
| client\_secret | The client secret to use | Y |  |
| oauth2\_scope | OAuth2 authentication scope | Y |  |
| oauth2\_server\_uri | Lakekeeper OAuth2 authentication URI | Y |  |
| warehouse | Warehouse name | Y |  |
| catalog\_uri | Lakekeeper REST Catalog URI | Y |  |

A `create server` statement example:

With VaultWithout Vault

```
1
create server duckdb_server
2
  foreign data wrapper duckdb_wrapper
3
  options (
4
    type 'lakekeeper',
5

6
    -- The client id saved in Vault
7
    vault_client_id '<client_id>',
8

9
    -- The client secret in Vault
10
    vault_client_secret '<secret>',
11

12
    -- OAuth2 authentication settings
13
    oauth2_scope 'lakekeeper',
14
    oauth2_server_uri 'http://keycloak:8080/realms/iceberg/protocol/openid-connect/token'
15

16
    -- Warehouse name
17
    warehouse 'warehouse',
18

19
    use_ssl 'false',
20

21
    -- Lakekeeper REST Catalog URI
22
    catalog_uri 'lakekeeper:8181/catalog'
23
  );
```

#### Iceberg [\#](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb\#iceberg)

This is to access generic Iceberg services. Check above for other specific Iceberg services like [S3 Tables](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb#aws-s3-tables), [R2 Data Catalog](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb#cloudflare-r2-data-catalog) and etc. All the [S3](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb#aws-s3) options are supported with below additional options.

Reading from Iceberg REST Catalogs backed by remote storage that is not S3 or S3 compatible is not supported yet.

| Server Option | Description | Required | Default |
| --- | --- | :-: | --- |
| type | Server type, must be `iceberg` | Y |  |
| warehouse | Warehouse name | Y |  |
| catalog\_uri | REST Catalog URI | Y |  |
| token | The API token to use |  |  |
| client\_id | The client ID to use |  |  |
| client\_secret | The client secret to use |  |  |
| oauth2\_scope | OAuth2 authentication scope |  |  |
| oauth2\_server\_uri | OAuth2 authentication URI |  |  |

A `create server` statement example used to access local Iceberg service:

With VaultWithout Vault

```
1
create server duckdb_server
2
  foreign data wrapper duckdb_wrapper
3
  options (
4
    type 'iceberg',
5

6
    -- The key id saved in Vault
7
    vault_key_id '<key_ID>',
8

9
    -- The secret saved in Vault
10
    vault_secret '<secret_key>',
11

12
    -- AWS region
13
    region 'us-east-1',
14

15
    -- S3 access settings
16
    endpoint 'localhost:8000',
17
    url_style 'path',
18
    use_ssl 'false',
19

20
    -- a dummy access token
21
    token 'dummy',
22

23
    -- Warehouse name
24
    warehouse 'warehouse',
25

26
    -- REST Catalog URI
27
    catalog_uri 'localhost:8181'
28
  );
```

### Create a schema [\#](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb\#create-a-schema)

We recommend creating a schema to hold all the foreign tables:

```
1
create schema if not exists iceberg;
```

## Options [\#](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb\#options)

The full list of foreign table options are below:

- `table` \- Fully qualified source table name in DuckDB, required.

This can also be a subquery enclosed in parentheses, for example,

```
1
table '(select * from my_table)'
```

or, an URI points to remote file or a function (with corresponding type of server),

```
1
table '''s3://my_bucket/products.parquet'''
```

```
1
table 'read_json(''s3://my_bucket/products.json'')'
```

## Entities [\#](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb\#entities)

We can use SQL [import foreign schema](https://www.postgresql.org/docs/current/sql-importforeignschema.html) to import foreign table definitions from DuckDB.

For example, using below SQL can automatically create foreign tables in the `duckdb` schema.

```
1
-- create all the foreign tables from Iceberg "docs_example" namespace
2
import foreign schema "docs_example"
3
  from server duckdb_server into duckdb;
4

5
-- or, only create "readme" and "guides" foreign tables
6
import foreign schema "docs_example"
7
  limit to ("readme", "guides")
8
  from server duckdb_server into duckdb;
9

10
-- or, create all foreign tables except "readme"
11
import foreign schema "docs_example"
12
  except ("readme")
13
  from server duckdb_server into duckdb;
```

Currently only Iceberg-like servers, such as S3 Tables, R2 Data Catalog and etc., support `import foreign schema` without specifying source tables. For other types of servers, source tables must be explicitly specified in options. For example,

```
1
-- 'duckdb_server_s3_tables' server type is 's3_tables', so all tables
2
-- under 'docs_example' namespace can be imported automatically
3
import foreign schema "docs_example"
4
  from server duckdb_server_s3_tables into duckdb;
5

6
-- 'duckdb_server_s3' server type is 's3', source tables to be imported
7
-- must be specified explicitly
8
import foreign schema s3
9
  from server duckdb_server_s3 into duckdb
10
  options (
11
    tables '
12
      s3://my_bucket/products.parquet,
13
      s3://my_bucket/users.json
14
	'
15
  );
```

The imported table name format from Iceberg-like server is:

- `<server_type>_<schema_name>_<table_name>`

For example, the above statement will import a table name `s3_tables_docs_example_guides`.

For other types of server with explicitly specified sources tables, the imported foreign table names have the schema and sequence number as prefix with this format:

- `<schema_name>_<sequence_number>_<filename_stem>`

For example, by using belew statement,

```
1
import foreign schema s3
2
  from server duckdb_server_s3 into duckdb
3
  options (
4
    tables '
5
      s3://my_bucket/products.parquet,
6
      s3://my_bucket/users.json
7
	'
8
  );
```

The imported foreign table names are:

- `s3_0_products`
- `s3_1_users`

By default, the `import foreign schema` statement will silently skip all the incompatible columns. Use the option `strict` to prevent this behavior. For example,

```
1
import foreign schema "docs_example" from server duckdb_server into duckdb
2
options (
3
  -- this will fail the 'import foreign schema' statement when DuckDB table
4
  -- column cannot be mapped to Postgres
5
  strict 'true'
6
);
```

### DuckDB Tables [\#](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb\#duckdb-tables)

This is an object representing DuckDB table.

Ref: [DuckDB Table](https://duckdb.org/docs/stable/sql/statements/create_table)

#### Operations [\#](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb\#operations)

| Object | Select | Insert | Update | Delete | Truncate |
| --- | :-: | :-: | :-: | :-: | :-: |
| table | ✅ | ❌ | ❌ | ❌ | ❌ |

#### Usage [\#](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb\#usage)

You can manually create the foreign table like below if you did not use `import foreign schema`.

```
1
create foreign table duckdb.products (
2
  id bigint,
3
  name text,
4
  sku text,
5
  created_at timestamp
6
)
7
  server duckdb_server
8
  options (
9
    table '''s3://my_bucket/products.parquet'''
10
  );
```

## Query Pushdown Support [\#](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb\#query-pushdown-support)

This FDW supports `where`, `order by` and `limit` clause pushdown.

## Supported Data Types [\#](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb\#supported-data-types)

| Postgres Type | DuckDB Type |
| --- | --- |
| boolean | BOOLEAN, BOOL, LOGICAL |
| "char" | TINYINT, INT1 |
| smallint | SMALLINT, INT2, SHORT |
| real | FLOAT, FLOAT4, REAL |
| integer | INTEGER, INT4, INT, SIGNED |
| double precision | DOUBLE, FLOAT8 |
| bigint | BIGINT, INT8, LONG |
| numeric | DECIMAL, NUMERIC |
| text | BIT, VARCHAR, CHAR, BPCHAR, TEXT, STRING |
| date | DATE |
| time | TIME |
| timestamp | TIMESTAMP, DATETIME |
| timestamptz | TIMESTAMP WITH TIME ZONE, TIMESTAMPTZ |
| jsonb | JSON, ARRAY, LIST, MAP, STRUCT, UNION |
| bytea | BLOB, BYTEA, BINARY, VARBINARY |
| uuid | UUID |

## Limitations [\#](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb\#limitations)

This section describes important limitations and considerations when using this FDW:

- Only supports certain server types, which data is stored remotely
- Only supports specific data type mappings between Postgres and DuckDB
- Only supports read operations (no INSERT, UPDATE, DELETE, or TRUNCATE)
- When using Iceberg REST Catalog, only supports AWS S3 (or compatible) as the storage
- Materialized views using these foreign tables may fail during logical backups

## Examples [\#](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb\#examples)

### Basic Example [\#](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb\#basic-example)

First, create a `s3` server:

```
1
create server duckdb_server
2
  foreign data wrapper duckdb_wrapper
3
  options (
4
    type 's3',
5
    key_id '<AWS_access_key_ID>',
6
    secret '<AWS_secret_access_key>',
7
    region 'us-east-1'
8
  );
```

Then import foreign table from a parquet file and query it:

```
1
import foreign schema s3
2
  from server duckdb_server into duckdb
3
  options (
4
    tables '
5
      s3://my_bucket/products.parquet
6
    '
7
  );
8

9
select * from duckdb.s3_0_products;
```

This is the same as creating the foreign table manually like below,

```
1
create foreign table duckdb.products (
2
  id bigint,
3
  name text,
4
  sku text,
5
  created_at timestamp
6
)
7
  server duckdb_server
8
  options (
9
    table '''s3://my_bucket/products.parquet'''
10
  );
11

12
select * from duckdb.products;
```

### Read AWS S3 Tables [\#](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb\#read-aws-s3-tables)

First, create a `s3_tables` server:

```
1
create server duckdb_server
2
  foreign data wrapper duckdb_wrapper
3
  options (
4
    type 's3_tables',
5
    key_id '<AWS_access_key_ID>',
6
    secret '<AWS_secret_access_key>',
7
    region 'us-east-1',
8
    s3_tables_arn 'arn:aws:s3tables:us-east-1:203212701384:bucket/my-bucket'
9
  );
```

Then, import all the tables in `docs_example` namespace and query it:

```
1
import foreign schema "docs_example"
2
  from server duckdb_server into duckdb;
3

4
select * from duckdb.s3_tables_docs_example_guides;
```

### Read Cloudflare R2 Data Catalog [\#](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb\#read-cloudflare-r2-data-catalog)

First, follow the steps in [Getting Started Guide](https://developers.cloudflare.com/r2/data-catalog/get-started/) to create a R2 Catalog on Cloudflare. Once it is completed, create a `r2_catalog` server like below:

```
1
create server duckdb_server
2
  foreign data wrapper duckdb_wrapper
3
  options (
4
    type 'r2_catalog',
5
    token '<R2 API token>',
6
    warehouse '2b303ef0293bc91a0217a0381af14a3e_r2-data-catalog-tutorial',
7
    catalog_uri 'catalog.cloudflarestorage.com/2b303ef0293bc91a0217a0381af14a3e/r2-data-catalog-tutorial'
8
  );
```

Then, import all the tables in `default` namespace and query it:

```
1
import foreign schema "default"
2
  from server duckdb_server into duckdb;
3

4
select * from duckdb.r2_catalog_default_people;
```

### Query Pushdown Examples [\#](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb\#query-pushdown-examples)

Follow the above [Read R2 Data Catalog example](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb#read-cloudflare-r2-data-catalog), below are some query pushdown examples:

```
1
-- the filter "name = 'Alice'" will be pushed down to DuckDB
2
select * from duckdb.r2_catalog_default_people where name = 'Alice';
3

4
-- multiple filters must use logical 'AND'
5
select * from duckdb.r2_catalog_default_people
6
where name = 'Alice' and score = 80;
7

8
-- 'order by' and 'limit' will be pushed down to DuckDB
9
select * from duckdb.r2_catalog_default_people order by id limit 2;
```

[Edit this page on GitHub](https://github.com/supabase/wrappers/blob/docs_v0.5.6/docs/catalog/duckdb.md)

### Is this helpful?

NoYes

### On this page

[Preparation](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb#preparation) [Enable Wrappers](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb#enable-wrappers) [Enable the DuckDB Wrapper](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb#enable-the-duckdb-wrapper) [Store your credentials (optional)](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb#store-your-credentials-optional) [Connecting to DuckDB](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb#connecting-to-duckdb) [Create a schema](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb#create-a-schema) [Options](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb#options) [Entities](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb#entities) [DuckDB Tables](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb#duckdb-tables) [Query Pushdown Support](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb#query-pushdown-support) [Supported Data Types](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb#supported-data-types) [Limitations](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb#limitations) [Examples](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb#examples) [Basic Example](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb#basic-example) [Read AWS S3 Tables](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb#read-aws-s3-tables) [Read Cloudflare R2 Data Catalog](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb#read-cloudflare-r2-data-catalog) [Query Pushdown Examples](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb#query-pushdown-examples)

- Need some help?
[Contact support](https://supabase.com/support)
- Latest product updates?
[See Changelog](https://supabase.com/changelog)
- Something's not right?
[Check system status](https://status.supabase.com/)

* * *

[© Supabase Inc](https://supabase.com/)— [Contributing](https://github.com/supabase/supabase/blob/master/apps/docs/DEVELOPERS.md) [Author Styleguide](https://github.com/supabase/supabase/blob/master/apps/docs/CONTRIBUTING.md) [Open Source](https://supabase.com/open-source) [SupaSquad](https://supabase.com/supasquad) Privacy Settings

[Twitter](https://twitter.com/supabase) [GitHub](https://github.com/supabase) [Discord](https://discord.supabase.com/) [Youtube](https://youtube.com/c/supabase)